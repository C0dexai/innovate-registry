<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Client SPA (Black Backdrop, Dark Blue Neon Frame)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Define Neon Colors as CSS variables for consistency */
        :root {
            --neon-blue: #00F0FF;
            --neon-purple: #B000FF;
            --neon-green: #00FF8C;
            --neon-pink: #FF00E6;
            --dark-grey-bg: #1A1A1A;
            --medium-grey-bg: #2B2B2B;
            --light-grey-text: #E0E0E0;
            --dark-text: #000000; /* For text on very bright neon */
            --dark-frame-blue: #0F1F40; /* A darker blue for the frame */
        }

        /* Custom Scrollbar Styles (Tiniest White Neon Phosphor Glow on Black) */
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px; /* Tiniest width */
            height: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #000000; /* Black background */
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.7); /* Semi-transparent white for phosphor glow */
            border-radius: 10px;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.8); /* Phosphor glow effect */
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 0 8px rgba(255, 255, 255, 1);
        }

        /* Apply Inter font globally and BLACK background for the body */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000; /* Solid black backdrop */
            color: var(--light-grey-text);
            padding: 20px; /* Add some padding to see the black backdrop around #root */
            margin: 0; /* Ensure no default margin on body */
        }

        /* Glowing Neon Trim for the main application container */
        #root {
            border: 2px solid var(--dark-frame-blue); /* Dark blue border */
            border-radius: 1rem; /* Rounded corners for the main app */
            box-shadow: 0 0 10px var(--dark-frame-blue), /* Dark blue subtle initial glow */
                        0 0 20px var(--neon-blue), /* Primary neon blue glow */
                        0 0 40px var(--neon-purple), /* Secondary neon purple glow */
                        0 0 60px var(--neon-green); /* Tertiary neon green glow */
            overflow: hidden; /* Ensures shadows are contained */
            display: flex; /* Ensure root fills the page content */
            flex-direction: column;
            min-height: calc(100vh - 40px); /* Adjust height for padding */
        }


        /* Neon Glow Utility Classes */
        .shadow-neon-blue {
            box-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue) inset;
        }
        .shadow-neon-purple {
            box-shadow: 0 0 10px var(--neon-purple), 0 0 20px var(--neon-purple) inset;
        }
        .shadow-neon-green {
            box-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green) inset;
        }
        .shadow-neon-pink {
            box-shadow: 0 0 10px var(--neon-pink), 0 0 20px var(--neon-pink) inset;
        }

        /* Keyframe for subtle pulse glow */
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 5px rgba(0, 240, 255, 0.5); }
            50% { box-shadow: 0 0 20px rgba(0, 240, 255, 0.8), 0 0 30px rgba(0, 240, 255, 0.6); }
            100% { box-shadow: 0 0 5px rgba(0, 240, 255, 0.5); }
        }

        .animate-pulse-glow {
            animation: pulse-glow 3s infinite alternate;
        }

        /* Adjusting existing Tailwind classes for neon theme */
        .bg-gray-900 {
            background-color: var(--dark-grey-bg); /* Use dark grey for app content background */
        }
        .bg-gray-800 {
            background-color: rgba(43, 43, 43, 0.7); /* Semi-transparent medium grey */
            backdrop-filter: blur(5px); /* Subtle blur for transparency effect */
        }
        .bg-gray-700 {
            background-color: rgba(60, 60, 60, 0.7); /* Slightly lighter semi-transparent grey */
            backdrop-filter: blur(5px);
        }
        .bg-gray-600 {
            background-color: rgba(77, 77, 77, 0.7);
            backdrop-filter: blur(5px);
        }
        .border-gray-700 {
            border-color: rgba(80, 80, 80, 0.8);
        }
        .border-gray-600 {
            border-color: rgba(90, 90, 90, 0.8);
        }
        .text-gray-300 {
            color: var(--light-grey-text);
        }
        .text-gray-400 {
            color: #A0A0A0;
        }

        /* Specific neon color overrides for buttons and accents */
        .bg-blue-600 { background-color: var(--neon-blue); color: var(--dark-text); }
        .hover\:bg-blue-700:hover { background-color: var(--neon-blue); filter: brightness(1.2); }
        .bg-green-600 { background-color: var(--neon-green); color: var(--dark-text); }
        .hover\:bg-green-700:hover { background-color: var(--neon-green); filter: brightness(1.2); }
        .bg-yellow-600 { background-color: var(--neon-pink); color: var(--dark-text); } /* Using pink for yellow as per request */
        .hover\:bg-yellow-700:hover { background-color: var(--neon-pink); filter: brightness(1.2); }
        .bg-red-600 { background-color: rgba(255, 0, 0, 0.8); } /* Keep red for danger, slightly transparent */
        .hover\:bg-red-700:hover { background-color: rgba(255, 0, 0, 1); }
        .bg-purple-600 { background-color: var(--neon-purple); color: var(--dark-text); }
        .bg-indigo-600 { background-color: var(--neon-purple); color: var(--dark-text); }
        .hover\:bg-indigo-700:hover { background-color: var(--neon-purple); filter: brightness(1.2); }

        /* Neon focus rings */
        .focus\:ring-blue-500:focus {
            outline: 2px solid var(--neon-blue);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(0, 240, 255, 0.5);
        }
        .focus\:border-blue-500:focus {
            border-color: var(--neon-blue);
        }

        /* Markdown content styling for notes */
        .markdown-content {
            text-align: left; /* Ensure overall left alignment */
        }

        .markdown-content p {
            margin-bottom: 0.5rem;
        }

        .markdown-content ul,
        .markdown-content ol {
            list-style-position: inside;
            margin-left: 1.5rem; /* Indent lists */
            margin-bottom: 0.5rem;
        }

        .markdown-content li {
            margin-bottom: 0.25rem;
        }

        /* Code block enhancements */
        .markdown-content pre {
            background-color: #1f2937; /* Darker gray for code block background */
            color: #e5e7eb; /* Light text color */
            padding: 1rem;
            border-radius: 0.5rem; /* Rounded corners */
            overflow-x: auto; /* Enable horizontal scrolling for long lines */
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', 'monospace'; /* Monospace font */
            line-height: 1.5;
            margin-top: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .markdown-content code {
            background-color: #374151; /* Slightly lighter gray for inline code */
            color: var(--neon-purple); /* Purple-ish color for code text */
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem; /* Rounded corners for inline code */
            font-size: 0.875em; /* Slightly smaller font for inline code */
        }

        .markdown-content pre code {
            /* Override inline code styles when inside a pre block */
            background-color: transparent;
            color: inherit;
            padding: 0;
            border-radius: 0;
        }

        /* Glowing Orb Styles */
        .glowing-orb-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .glowing-orb {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8), var(--neon-blue) 50%, transparent 70%);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            position: relative;
            animation: pulse-orb 2s infinite alternate;
            transition: all 0.3s ease-in-out;
            border: 2px solid var(--neon-blue);
        }

        .glowing-orb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--neon-blue), 0 0 40px var(--neon-blue);
        }

        @keyframes pulse-orb {
            0% { box-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue) inset; }
            50% { box-shadow: 0 0 25px var(--neon-blue), 0 0 50px var(--neon-blue) inset; }
            100% { box-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue) inset; }
        }

        /* Quick Menu Styles */
        .quick-menu {
            position: absolute;
            bottom: 80px; /* Position above the orb */
            right: 0;
            background-color: rgba(43, 43, 43, 0.8); /* Semi-transparent background */
            border: 1px solid var(--neon-blue);
            border-radius: 0.75rem;
            box-shadow: 0 0 15px var(--neon-blue);
            backdrop-filter: blur(8px); /* Stronger blur for the menu */
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            min-width: 180px;
        }

        .quick-menu button {
            width: 100%;
            padding: 0.75rem 1rem;
            background-color: rgba(0, 0, 0, 0.5); /* Slightly transparent button background */
            color: var(--light-grey-text);
            border-radius: 0.5rem;
            transition: background-color 0.2s, box-shadow 0.2s, color 0.2s;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 0.75rem;
        }

        .quick-menu button:hover {
            background-color: var(--neon-blue);
            color: var(--dark-text);
            box-shadow: 0 0 10px var(--neon-blue);
        }

        /* Tailwind overrides for glowing elements */
        .shadow-lg {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.1); /* Keep base shadow */
            transition: box-shadow 0.3s ease-in-out;
        }

        /* Special hover effect for main navigation buttons */
        .nav-button-active {
             background-color: var(--neon-blue);
             color: var(--dark-text); /* Black text on neon tab */
             box-shadow: 0 0 15px var(--neon-blue), 0 0 25px var(--neon-blue) inset;
        }
        .nav-button-inactive:hover {
            background-color: rgba(0, 240, 255, 0.2); /* Subtle neon tint on hover (using blue as example) */
            color: var(--light-grey-text);
            box-shadow: 0 0 8px var(--neon-blue);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen flex flex-col">
    <div id="root" class="flex flex-1 flex-col"></div>

    <!-- React and ReactDOM CDNs -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        // --- Lucide React Icons (converted to inline SVG components) ---
        const MessageSquare = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" /></svg>
        );
        const Users = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/></svg>
        );
        const Settings = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.78 1.22a2 2 0 0 0 .73 2.73l.04.04a2 2 0 0 1 0 2.83l-.04.04a2 2 0 0 0-.73 2.73l.78 1.22a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.78-1.22a2 2 0 0 0-.73-2.73l-.04-.04a2 2 0 0 1 0-2.83l.04-.04a2 2 0 0 0 .73-2.73l-.78-1.22a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
        );
        const Plus = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 5v14M5 12h14"/></svg>
        );
        const Edit = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
        );
        const Trash2 = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 6h18"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
        );
        const Save = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
        );
        const X = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 6L6 18M6 6l12 12"/></svg>
        );
        const Eye = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
        );
        const EyeOff = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-10-7-10-7a1.8 1.8 0 0 1 0-.22"/><path d="M14.12 14.12a3 3 0 1 1-4.24-4.24"/><path d="M1.94 1.94A10.07 10.07 0 0 0 2 13c0 0 3 7 10 7a1.8 1.8 0 0 0 .22 0"/><line x1="2" y1="2" x2="22" y2="22"/></svg>
        );
        const Send = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="22" y1="2" x2="11" y2="13"/><path d="M22 2L15 22l-3-7L2 12l20-10z"/></svg>
        );
        const Loader2 = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
        );
        const Copy = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
        );
        const NotebookPen = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 20h9"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M10 2v4"/><path d="M10 10.5L17.5 3l3.5 3.5L13.5 14l-3.5.5.5-3.5z"/></svg>
        );
        const CheckCircle = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
        );
        const Circle = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/></svg>
        );
        const Terminal = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>
        );

        // Destructure React hooks from the global React object
        const { useState, useEffect, useRef, useCallback, useImperativeHandle, forwardRef } = React;

        // --- IndexedDB Hook ---
        const useIndexedDB = () => {
            const [db, setDb] = useState(null);
            const [isDbReady, setIsDbReady] = useState(false);
            const DB_NAME = 'MCPClientDB';
            const DB_VERSION = 1;

            const openDatabase = useCallback(() => {
                return new Promise((resolve, reject) => {
                    const request = indexedDB.open(DB_NAME, DB_VERSION);

                    request.onupgradeneeded = (event) => {
                        const db = event.target.result;
                        // Create object stores if they don't exist
                        if (!db.objectStoreNames.contains('agents')) {
                            db.createObjectStore('agents', { keyPath: 'id' });
                        }
                        if (!db.objectStoreNames.contains('notes')) {
                            db.createObjectStore('notes', { keyPath: 'id', autoIncrement: true });
                        }
                        if (!db.objectStoreNames.contains('todos')) {
                            db.createObjectStore('todos', { keyPath: 'id', autoIncrement: true });
                        }
                        if (!db.objectStoreNames.contains('settings')) {
                            db.createObjectStore('settings', { keyPath: 'key' }); // To store API keys, etc.
                        }
                    };

                    request.onsuccess = (event) => {
                        const dbInstance = event.target.result;
                        setDb(dbInstance);
                        setIsDbReady(true);
                        resolve(dbInstance);
                    };

                    request.onerror = (event) => {
                        console.error("IndexedDB error:", event.target.errorCode);
                        reject(new Error("Failed to open IndexedDB."));
                    };
                });
            }, []);

            useEffect(() => {
                openDatabase();
            }, [openDatabase]);

            // Generic IndexedDB operations
            const getObjectStore = useCallback((storeName, mode) => {
                if (!db) {
                    console.error("IndexedDB not ready.");
                    return null;
                }
                const transaction = db.transaction([storeName], mode);
                return transaction.objectStore(storeName);
            }, [db]);

            const getAll = useCallback(async (storeName) => {
                return new Promise((resolve, reject) => {
                    const store = getObjectStore(storeName, 'readonly');
                    if (!store) {
                        resolve([]);
                        return;
                    }
                    const request = store.getAll();
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = (event) => reject(event.target.error);
                });
            }, [getObjectStore]);

            const get = useCallback(async (storeName, key) => {
                return new Promise((resolve, reject) => {
                    const store = getObjectStore(storeName, 'readonly');
                    if (!store) {
                        resolve(undefined);
                        return;
                    }
                    const request = store.get(key);
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = (event) => reject(event.target.error);
                });
            }, [getObjectStore]);

            const add = useCallback(async (storeName, data) => {
                return new Promise((resolve, reject) => {
                    const store = getObjectStore(storeName, 'readwrite');
                    if (!store) {
                        reject(new Error("Object store not available."));
                        return;
                    }
                    // If keyPath is autoIncrement, id should not be provided for add
                    const dataToStore = { ...data };
                    if (store.autoIncrement && !dataToStore.id) {
                        delete dataToStore.id; // Let IndexedDB generate it
                    } else if (!dataToStore.id) {
                        dataToStore.id = crypto.randomUUID(); // Manual ID for non-autoIncrement
                    }

                    const request = store.add(dataToStore);
                    request.onsuccess = () => resolve({ ...dataToStore, id: request.result });
                    request.onerror = (event) => reject(event.target.error);
                });
            }, [getObjectStore]);

            const put = useCallback(async (storeName, data) => {
                return new Promise((resolve, reject) => {
                    const store = getObjectStore(storeName, 'readwrite');
                    if (!store) {
                        reject(new Error("Object store not available."));
                        return;
                    }
                    const request = store.put(data);
                    request.onsuccess = () => resolve(data);
                    request.onerror = (event) => reject(event.target.error);
                });
            }, [getObjectStore]);

            const remove = useCallback(async (storeName, key) => {
                return new Promise((resolve, reject) => {
                    const store = getObjectStore(storeName, 'readwrite');
                    if (!store) {
                        reject(new Error("Object store not available."));
                        return;
                    }
                    const request = store.delete(key);
                    request.onsuccess = () => resolve(key);
                    request.onerror = (event) => reject(event.target.error);
                });
            }, [getObjectStore]);

            return { db, isDbReady, getAll, get, add, put, remove };
        };

        // --- Agent Card Component ---
        const AgentCard = ({ agent, onSave, onDelete, onCancel, isEditing, onEditStart, onCardClick }) => {
            const [editedAgent, setEditedAgent] = useState(agent);
            const [showConfirmDelete, setShowConfirmDelete] = useState(false);

            useEffect(() => {
                setEditedAgent(agent);
            }, [agent]);

            const handleChange = (e) => {
                const { name, value } = e.target;
                setEditedAgent(prev => ({ ...prev, [name]: value }));
            };

            const handleCapabilityChange = (capability) => {
                setEditedAgent(prev => ({
                    ...prev,
                    capabilities: {
                        ...prev.capabilities,
                        [capability]: !prev.capabilities[capability]
                    }
                }));
            };

            const handleSave = () => {
                onSave(editedAgent);
            };

            const handleDeleteClick = (e) => {
                e.stopPropagation(); // Prevent card click when deleting
                setShowConfirmDelete(true);
            };

            const handleConfirmDelete = () => {
                onDelete(agent.id);
                setShowConfirmDelete(false);
            };

            const handleCancelDelete = () => {
                setShowConfirmDelete(false);
            };

            return (
                <div
                    className="bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-xl shadow-lg border border-gray-700 transition-all duration-300 cursor-pointer group"
                    onClick={() => !isEditing && onCardClick(agent)}
                    style={{
                        borderColor: `var(--neon-blue)`, // Base neon border
                        boxShadow: `0 0 8px var(--neon-blue)`
                    }}
                >
                    {/* Hover effect for the card itself */}
                    <div className="absolute inset-0 rounded-xl transition-all duration-300 group-hover:shadow-neon-blue group-hover:border-var(--neon-blue)"></div>

                    {isEditing ? (
                        <div className="space-y-4 relative z-10">
                            <div>
                                <label htmlFor={`name-${agent.id}`} className="block text-sm font-medium text-gray-300 mb-1">Agent Name</label>
                                <input
                                    type="text"
                                    id={`name-${agent.id}`}
                                    name="name"
                                    value={editedAgent.name}
                                    onChange={handleChange}
                                    className="w-full p-2 rounded-md bg-gray-700 text-white border border-gray-600 focus:ring-blue-500 focus:border-blue-500"
                                />
                            </div>
                            <div>
                                <label htmlFor={`description-${agent.id}`} className="block text-sm font-medium text-gray-300 mb-1">Description</label>
                                <textarea
                                    id={`description-${agent.id}`}
                                    name="description"
                                    value={editedAgent.description}
                                    onChange={handleChange}
                                    rows="3"
                                    className="w-full p-2 rounded-md bg-gray-700 text-white border border-gray-600 focus:ring-blue-500 focus:border-blue-500"
                                ></textarea>
                            </div>
                            <div className="flex items-center space-x-4">
                                <span className="text-sm font-medium text-gray-300">Status:</span>
                                <select
                                    name="status"
                                    value={editedAgent.status}
                                    onChange={handleChange}
                                    className="p-2 rounded-md bg-gray-700 text-white border border-gray-600 focus:ring-blue-500 focus:border-blue-500"
                                >
                                    <option value="Online">Online</option>
                                    <option value="Offline">Offline</option>
                                    <option value="Busy">Busy</option>
                                </select>
                            </div>

                            <div className="pt-2">
                                <h4 className="text-md font-semibold text-gray-200 mb-2">Capabilities</h4>
                                <div className="flex flex-wrap gap-3">
                                    {Object.keys(editedAgent.capabilities || {}).map(cap => (
                                        <button
                                            key={cap}
                                            onClick={() => handleCapabilityChange(cap)}
                                            className={`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${
                                                editedAgent.capabilities[cap]
                                                    ? 'bg-green-600 text-dark-text hover:shadow-neon-green'
                                                    : 'bg-gray-600 text-gray-300 hover:bg-gray-500'
                                            }`}
                                        >
                                            {cap} {editedAgent.capabilities[cap] ? <Eye size={16} className="inline-block ml-1" /> : <EyeOff size={16} className="inline-block ml-1" />}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="pt-2">
                                <h4 className="text-md font-semibold text-gray-200 mb-2">Bindings (to other agents)</h4>
                                <div className="flex flex-wrap gap-3">
                                    {editedAgent.bindings && editedAgent.bindings.length > 0 ? (
                                        editedAgent.bindings.map(bindingId => (
                                            <span key={bindingId} className="px-3 py-1 rounded-full bg-blue-600 text-dark-text text-sm">
                                                Bound to: {bindingId.substring(0, 8)}...
                                            </span>
                                        ))
                                    ) : (
                                        <span className="text-gray-400 text-sm">No bindings configured.</span>
                                    )}
                                </div>
                            </div>

                            <div className="flex justify-end space-x-3 mt-4">
                                <button
                                    onClick={handleSave}
                                    className="flex items-center px-4 py-2 bg-blue-600 text-dark-text rounded-lg hover:shadow-neon-blue transition-all duration-200 shadow-md"
                                >
                                    <Save size={18} className="mr-2" /> Save
                                </button>
                                <button
                                    onClick={onCancel}
                                    className="flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 shadow-md"
                                >
                                    <X size={18} className="mr-2" /> Cancel
                                </button>
                            </div>
                        </div>
                    ) : (
                        <div className="space-y-3 relative z-10">
                            <div className="flex items-center justify-between">
                                <h3 className="text-2xl font-bold text-white">{agent.name}</h3>
                                <span className={`px-3 py-1 rounded-full text-sm font-semibold ${
                                    agent.status === 'Online' ? 'bg-green-600 text-dark-text' :
                                    agent.status === 'Offline' ? 'bg-red-600 text-white' :
                                    'bg-yellow-600 text-dark-text'
                                }`}>
                                    {agent.status}
                                </span>
                            </div>
                            <p className="text-gray-300 text-sm">{agent.description}</p>
                            <div className="flex flex-wrap gap-2 pt-2">
                                {Object.keys(agent.capabilities || {}).map(cap => agent.capabilities[cap] && (
                                    <span key={cap} className="px-3 py-1 rounded-full bg-indigo-600 text-dark-text text-xs font-medium">
                                        {cap}
                                    </span>
                                ))}
                            </div>
                            {agent.bindings && agent.bindings.length > 0 && (
                                <div className="pt-2">
                                    <h4 className="text-sm font-semibold text-gray-400 mb-1">Bound To:</h4>
                                    <div className="flex flex-wrap gap-2">
                                        {agent.bindings.map(bindingId => (
                                            <span key={bindingId} className="px-3 py-1 rounded-full bg-purple-600 text-dark-text text-xs">
                                                {bindingId.substring(0, 8)}...
                                            </span>
                                        ))}
                                    </div>
                                </div>
                            )}
                            <div className="flex justify-end space-x-2 mt-4">
                                <button
                                    onClick={onEditStart}
                                    className="flex items-center px-3 py-1.5 bg-yellow-600 text-dark-text rounded-lg hover:shadow-neon-pink transition-all duration-200 shadow-md text-sm"
                                >
                                    <Edit size={16} className="mr-1" /> Edit
                                </button>
                                <button
                                    onClick={handleDeleteClick}
                                    className="flex items-center px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200 shadow-md text-sm"
                                >
                                    <Trash2 size={16} className="mr-1" /> Delete
                                </button>
                            </div>

                            {showConfirmDelete && (
                                <div className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50">
                                    <div className="bg-gray-800 p-6 rounded-lg shadow-xl border border-gray-700 text-center">
                                        <p className="text-lg text-white mb-4">Are you sure you want to delete "{agent.name}"?</p>
                                        <div className="flex justify-center space-x-4">
                                            <button
                                                onClick={handleConfirmDelete}
                                                className="px-5 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
                                            >
                                                Yes, Delete
                                            </button>
                                            <button
                                                onClick={handleCancelDelete}
                                                className="px-5 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
                                            >
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        // --- Chat Interface Component ---
        const ChatInterface = ({ messages, onSendMessage, geminiApiKey }) => {
            const [input, setInput] = useState('');
            const messagesEndRef = useRef(null);
            const [isLoading, setIsLoading] = useState(false);
            const [copiedMessageId, setCopiedMessageId] = useState(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            const handleCopy = (text, messageId) => {
                try {
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    setCopiedMessageId(messageId);
                    setTimeout(() => setCopiedMessageId(null), 1500); // Clear "Copied!" after 1.5 seconds
                } catch (err) {
                    console.error('Failed to copy text: ', err);
                }
            };

            const handleSend = async () => {
                if (input.trim()) {
                    const userMessage = { sender: 'User', text: input, timestamp: new Date().toLocaleTimeString(), id: Date.now() };
                    onSendMessage(userMessage);
                    setInput('');
                    setIsLoading(true); // Start loading

                    try {
                        // Simulate API call to Gemini for agent response
                        const chatHistory = [{ role: "user", parts: [{ text: input }] }];
                        const payload = { contents: chatHistory };
                        // Use the provided geminiApiKey, or an empty string if not set
                        const apiKey = geminiApiKey || "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const agentResponseText = result.candidates[0].content.parts[0].text;
                            const agentMessage = { sender: 'AI Agent', text: agentResponseText, timestamp: new Date().toLocaleTimeString(), id: Date.now() + 1 }; // Unique ID for agent message
                            onSendMessage(agentMessage); // Add agent's response to chat
                        } else {
                            onSendMessage({ sender: 'System', text: 'Error: No response from AI agent.', timestamp: new Date().toLocaleTimeString(), id: Date.now() + 1 });
                        }
                    } catch (error) {
                        console.error("Error calling Gemini API:", error);
                        onSendMessage({ sender: 'System', text: `Error: Could not connect to AI. ${error.message}`, timestamp: new Date().toLocaleTimeString(), id: Date.now() + 1 });
                    } finally {
                        setIsLoading(false); // End loading
                    }
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSend();
                }
            };

            return (
                <div className="flex flex-col h-full bg-gray-800 rounded-lg shadow-lg border border-gray-700">
                    <div className="flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar">
                        {messages.map((msg) => (
                            <div key={msg.id} className={`flex ${msg.sender === 'User' ? 'justify-end' : 'justify-start'}`}>
                                <div className={`max-w-[70%] p-3 rounded-lg shadow-md relative ${
                                    msg.sender === 'User' ? 'bg-blue-600 text-dark-text' :
                                    msg.sender === 'AI Agent' ? 'bg-purple-600 text-dark-text' :
                                    'bg-gray-600 text-white'
                                }`}>
                                    <div className="font-semibold text-sm mb-1 flex justify-between items-center">
                                        <span>{msg.sender} <span className="text-gray-300 text-xs ml-2">{msg.timestamp}</span></span>
                                        <button
                                            onClick={() => handleCopy(msg.text, msg.id)}
                                            className="ml-2 p-1 rounded-full text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200"
                                            title="Copy message"
                                        >
                                            {copiedMessageId === msg.id ? (
                                                <span className="text-xs">Copied!</span>
                                            ) : (
                                                <Copy size={16} />
                                            )}
                                        </button>
                                    </div>
                                    <p className="text-sm">{msg.text}</p>
                                </div>
                            </div>
                        ))}
                        {isLoading && (
                            <div className="flex justify-start">
                                <div className="max-w-[70%] p-3 rounded-lg shadow-md bg-gray-700 text-white flex items-center">
                                    <Loader2 className="animate-spin mr-2" size={18} />
                                    <span className="text-sm">Agent is thinking...</span>
                                </div>
                            </div>
                        )}
                        <div ref={messagesEndRef} />
                    </div>
                    <div className="p-4 border-t border-gray-700 flex items-center space-x-3">
                        <textarea
                            className="flex-1 p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-blue-500 focus:border-blue-500 resize-none custom-scrollbar"
                            placeholder="Type your message..."
                            value={input}
                            onChange={(e) => setInput(e.target.value)}
                            onKeyPress={handleKeyPress}
                            rows="1"
                            style={{ minHeight: '40px', maxHeight: '120px' }}
                        />
                        <button
                            onClick={handleSend}
                            className="p-3 bg-blue-600 text-dark-text rounded-lg hover:shadow-neon-blue transition-colors duration-200 shadow-md flex items-center justify-center"
                            disabled={isLoading}
                        >
                            <Send size={20} />
                        </button>
                    </div>
                </div>
            );
        };

        // --- Notes and Todos Page Component ---
        const NotesAndTodosPage = ({ dbOperations }) => {
            const { getAll, add, put, remove } = dbOperations;
            const [notes, setNotes] = useState([]);
            const [todos, setTodos] = useState([]);
            const [newNoteTitle, setNewNoteTitle] = useState('');
            const [newNoteContent, setNewNoteContent] = useState('');
            const [editingNoteId, setEditingNoteId] = useState(null);
            const [editedNoteTitle, setEditedNoteTitle] = useState('');
            const [editedNoteContent, setEditedNoteContent] = useState('');
            const [newTodoText, setNewTodoText] = useState('');
            const [showConfirmNoteDelete, setShowConfirmNoteDelete] = useState(null);
            const [showConfirmTodoDelete, setShowConfirmTodoDelete] = useState(null);

            const fetchNotes = useCallback(async () => {
                try {
                    const fetched = await getAll('notes');
                    setNotes(fetched);
                }
                catch (error) {
                    console.error("Error fetching notes:", error);
                }
            }, [getAll]);

            const fetchTodos = useCallback(async () => {
                try {
                    const fetched = await getAll('todos');
                    setTodos(fetched);
                }
                catch (error) {
                    console.error("Error fetching todos:", error);
                }
            }, [getAll]);

            useEffect(() => {
                fetchNotes();
                fetchTodos();
            }, [fetchNotes, fetchTodos]);

            // Notes Handlers
            const handleAddNote = async () => {
                if (!newNoteTitle.trim() || !newNoteContent.trim()) return;
                try {
                    await add('notes', {
                        title: newNoteTitle,
                        content: newNoteContent,
                        createdAt: new Date().toISOString()
                    });
                    setNewNoteTitle('');
                    setNewNoteContent('');
                    fetchNotes(); // Re-fetch to update UI
                } catch (e) {
                    console.error("Error adding note: ", e);
                }
            };

            const handleEditNoteStart = (note) => {
                setEditingNoteId(note.id);
                setEditedNoteTitle(note.title);
                setEditedNoteContent(note.content);
            };

            const handleSaveNote = async (noteId) => {
                if (!editedNoteTitle.trim() || !editedNoteContent.trim()) return;
                try {
                    await put('notes', {
                        id: noteId,
                        title: editedNoteTitle,
                        content: editedNoteContent
                    });
                    setEditingNoteId(null);
                    fetchNotes(); // Re-fetch to update UI
                } catch (e) {
                    console.error("Error updating note: ", e);
                }
            };

            const handleCancelNoteEdit = () => {
                setEditingNoteId(null);
            };

            const handleDeleteNoteClick = (noteId) => {
                setShowConfirmNoteDelete(noteId);
            };

            const handleConfirmNoteDelete = async () => {
                if (!showConfirmNoteDelete) return;
                try {
                    await remove('notes', showConfirmNoteDelete);
                    setShowConfirmNoteDelete(null);
                    fetchNotes(); // Re-fetch to update UI
                } catch (e) {
                    console.error("Error deleting note: ", e);
                }
            };

            const handleCancelNoteDelete = () => {
                setShowConfirmNoteDelete(null);
            };

            // Todos Handlers
            const handleAddTodo = async () => {
                if (!newTodoText.trim()) return;
                try {
                    await add('todos', {
                        text: newTodoText,
                        completed: false,
                        createdAt: new Date().toISOString()
                    });
                    setNewTodoText('');
                    fetchTodos(); // Re-fetch to update UI
                } catch (e) {
                    console.error("Error adding todo: ", e);
                }
            };

            const handleToggleTodoComplete = async (todo) => {
                try {
                    await put('todos', {
                        ...todo,
                        completed: !todo.completed
                    });
                    fetchTodos(); // Re-fetch to update UI
                } catch (e) {
                    console.error("Error toggling todo: ", e);
                }
            };

            const handleDeleteTodoClick = (todoId) => {
                setShowConfirmTodoDelete(todoId);
            };

            const handleConfirmTodoDelete = async () => {
                if (!showConfirmTodoDelete) return;
                try {
                    await remove('todos', showConfirmTodoDelete);
                    setShowConfirmTodoDelete(null);
                    fetchTodos(); // Re-fetch to update UI
                } catch (e) {
                    console.error("Error deleting todo: ", e);
                }
            };

            const handleCancelTodoDelete = () => {
                setShowConfirmTodoDelete(null);
            };

            return (
                <div className="flex flex-col h-full bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6">
                    <h2 className="text-3xl font-bold text-white mb-6">Notes & Todos</h2>

                    {/* Notes Section */}
                    <div className="mb-8">
                        <h3 className="text-2xl font-semibold text-white mb-4">My Notes</h3>
                        <div className="bg-gray-700 p-4 rounded-lg mb-6">
                            <input
                                type="text"
                                placeholder="Note Title"
                                value={newNoteTitle}
                                onChange={(e) => setNewNoteTitle(e.target.value)}
                                className="w-full p-2 rounded-md bg-gray-600 text-white border border-gray-500 focus:ring-blue-500 focus:border-blue-500"
                            />
                            <textarea
                                placeholder="Note Content (supports Markdown)"
                                value={newNoteContent}
                                onChange={(e) => setNewNoteContent(e.target.value)}
                                rows="3"
                                className="w-full p-2 rounded-md bg-gray-600 text-white border border-gray-500 mb-2 resize-none focus:ring-blue-500 focus:border-blue-500"
                            ></textarea>
                            <button
                                onClick={handleAddNote}
                                className="flex items-center px-4 py-2 bg-blue-600 text-dark-text rounded-lg hover:shadow-neon-blue transition-colors duration-200 shadow-md"
                            >
                                <Plus size={18} className="mr-2" /> Add Note
                            </button>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            {notes.length > 0 ? (
                                notes.map(note => (
                                    <div key={note.id} className="bg-gray-700 p-4 rounded-lg shadow-md border border-gray-600">
                                        {editingNoteId === note.id ? (
                                            <div className="space-y-2">
                                                <input
                                                    type="text"
                                                    value={editedNoteTitle}
                                                    onChange={(e) => setEditedNoteTitle(e.target.value)}
                                                    className="w-full p-2 rounded-md bg-gray-600 text-white border border-gray-500 focus:ring-blue-500 focus:border-blue-500"
                                                />
                                                <textarea
                                                    value={editedNoteContent}
                                                    onChange={(e) => setEditedNoteContent(e.target.value)}
                                                    rows="3"
                                                    className="w-full p-2 rounded-md bg-gray-600 text-white border border-gray-500 resize-none focus:ring-blue-500 focus:border-blue-500"
                                                ></textarea>
                                                <div className="flex justify-end space-x-2">
                                                    <button
                                                        onClick={() => handleSaveNote(note.id)}
                                                        className="flex items-center px-3 py-1.5 bg-blue-600 text-dark-text rounded-lg hover:shadow-neon-blue transition-colors duration-200 text-sm"
                                                    >
                                                        <Save size={16} className="mr-1" /> Save
                                                    </button>
                                                    <button
                                                        onClick={handleCancelNoteEdit}
                                                        className="flex items-center px-3 py-1.5 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 text-sm"
                                                    >
                                                        <X size={16} className="mr-1" /> Cancel
                                                    </button>
                                                </div>
                                            </div>
                                        ) : (
                                            <div>
                                                <h4 className="text-xl font-semibold text-white mb-2">{note.title}</h4>
                                                {/* Render Markdown content */}
                                                <div
                                                    className="text-gray-300 text-sm mb-4 markdown-content"
                                                    dangerouslySetInnerHTML={{ __html: marked.parse(note.content || '') }}
                                                />
                                                <div className="flex justify-end space-x-2">
                                                    <button
                                                        onClick={() => handleEditNoteStart(note)}
                                                        className="flex items-center px-3 py-1.5 bg-yellow-600 text-dark-text rounded-lg hover:shadow-neon-pink transition-colors duration-200 text-sm"
                                                    >
                                                        <Edit size={16} className="mr-1" /> Edit
                                                    </button>
                                                    <button
                                                        onClick={() => handleDeleteNoteClick(note.id)}
                                                        className="flex items-center px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200 text-sm"
                                                    >
                                                        <Trash2 size={16} className="mr-1" /> Delete
                                                    </button>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                ))
                            ) : (
                                <p className="text-gray-400 col-span-full text-center">No notes added yet.</p>
                            )}
                        </div>
                    </div>

                    {/* Todos Section */}
                    <div>
                        <h3 className="text-2xl font-semibold text-white mb-4">My Todos</h3>
                        <div className="bg-gray-700 p-4 rounded-lg mb-6 flex items-center space-x-3">
                            <input
                                type="text"
                                placeholder="Add a new todo..."
                                value={newTodoText}
                                onChange={(e) => setNewTodoText(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && handleAddTodo()}
                                className="flex-1 p-2 rounded-md bg-gray-600 text-white border border-gray-500 focus:ring-blue-500 focus:border-blue-500"
                            />
                            <button
                                onClick={handleAddTodo}
                                className="flex items-center px-4 py-2 bg-blue-600 text-dark-text rounded-lg hover:shadow-neon-blue transition-colors duration-200 shadow-md"
                            >
                                <Plus size={18} className="mr-2" /> Add Todo
                            </button>
                        </div>

                        <div className="space-y-3">
                            {todos.length > 0 ? (
                                todos.map(todo => (
                                    <div key={todo.id} className="bg-gray-700 p-4 rounded-lg shadow-md border border-gray-600 flex items-center justify-between">
                                        <div className="flex items-center space-x-3">
                                            <button
                                                onClick={() => handleToggleTodoComplete(todo)}
                                                className="text-gray-300 hover:text-green-400 transition-colors duration-200"
                                            >
                                                {todo.completed ? <CheckCircle size={24} className="text-green-600" /> : <Circle size={24} />}
                                            </button>
                                            <span className={`text-white text-lg ${todo.completed ? 'line-through text-gray-400' : ''}`}>
                                                {todo.text}
                                            </span>
                                        </div>
                                        <button
                                            onClick={() => handleDeleteTodoClick(todo.id)}
                                            className="p-2 rounded-full text-gray-300 hover:bg-gray-600 hover:text-red-400 transition-colors duration-200"
                                            title="Delete todo"
                                        >
                                            <Trash2 size={20} />
                                        </button>
                                    </div>
                                ))
                            ) : (
                                <p className="text-gray-400 text-center">No todo items yet. Add one above!</p>
                            )}
                        </div>
                    </div>

                    {/* Confirmation Modals */}
                    {showConfirmNoteDelete && (
                        <div className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50">
                            <div className="bg-gray-800 p-6 rounded-lg shadow-xl border border-gray-700 text-center">
                                <p className="text-lg text-white mb-4">Are you sure you want to delete this note?</p>
                                <div className="flex justify-center space-x-4">
                                    <button
                                        onClick={handleConfirmNoteDelete}
                                        className="px-5 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
                                    >
                                        Yes, Delete
                                    </button>
                                    <button
                                        onClick={handleCancelNoteDelete}
                                        className="px-5 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showConfirmTodoDelete && (
                        <div className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50">
                            <div className="bg-gray-800 p-6 rounded-lg shadow-xl border border-gray-700 text-center">
                                <p className="text-lg text-white mb-4">Are you sure you want to delete this todo item?</p>
                                <div className="flex justify-center space-x-4">
                                    <button
                                        onClick={handleConfirmTodoDelete}
                                        className="px-5 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
                                    >
                                        Yes, Delete
                                    </button>
                                    <button
                                        onClick={handleCancelTodoDelete}
                                        className="px-5 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // --- Terminal Console Component ---
        const TerminalConsole = forwardRef((props, ref) => {
            const [output, setOutput] = useState([]);
            const [input, setInput] = useState('');
            const [history, setHistory] = useState([]);
            const [historyIndex, setHistoryIndex] = useState(-1);
            const terminalEndRef = useRef(null);
            const inputRef = useRef(null);

            // Expose addOutput function to parent component
            useImperativeHandle(ref, () => ({
                addOutput: (line) => {
                    setOutput(prev => [...prev, line]);
                },
                clear: () => {
                    setOutput([]);
                }
            }));

            useEffect(() => {
                terminalEndRef.current?.scrollIntoView({ behavior: "smooth" });
            }, [output]);

            useEffect(() => {
                inputRef.current?.focus();
            }, []);

            const processCommand = (command) => {
                let response = '';
                if (command.toLowerCase() === 'help') {
                    response = 'Available commands: help, echo [text], clear, date, whoami';
                } else if (command.toLowerCase().startsWith('echo ')) {
                    response = command.substring(5);
                } else if (command.toLowerCase() === 'clear') {
                    setOutput([]);
                    return;
                } else if (command.toLowerCase() === 'date') {
                    response = new Date().toLocaleString();
                } else if (command.toLowerCase() === 'whoami') {
                    response = 'You are a user interacting with the MCP Client terminal.';
                } else {
                    response = `Command not found: ${command}`;
                }
                setOutput(prev => [...prev, `$ ${command}`, response]);
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const command = input.trim();
                    if (command) {
                        setHistory(prev => [command, ...prev]);
                        setHistoryIndex(-1); // Reset history index
                        processCommand(command);
                        setInput('');
                    }
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (history.length > 0 && historyIndex < history.length - 1) {
                        const newIndex = historyIndex + 1;
                        setHistoryIndex(newIndex);
                        setInput(history[newIndex]);
                    }
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (historyIndex > 0) {
                        const newIndex = historyIndex - 1;
                        setHistoryIndex(newIndex);
                        setInput(history[newIndex]);
                    } else {
                        setHistoryIndex(-1);
                        setInput('');
                    }
                }
            };

            return (
                <div className="flex flex-col h-full bg-gray-900 text-green-400 font-mono rounded-lg shadow-lg border border-gray-700">
                    <div className="flex-1 overflow-y-auto custom-scrollbar text-sm">
                        {output.map((line, index) => (
                            <pre key={index} className="whitespace-pre-wrap">{line}</pre>
                        ))}
                        <div ref={terminalEndRef} />
                    </div>
                    <div className="flex items-center mt-4 border-t border-gray-700 pt-4">
                        <span className="text-green-500 mr-2">$</span>
                        <input
                            ref={inputRef}
                            type="text"
                            className="flex-1 bg-transparent border-none outline-none text-green-400 caret-green-400"
                            value={input}
                            onChange={(e) => setInput(e.target.value)}
                            onKeyDown={handleKeyPress}
                            spellCheck="false"
                            autoComplete="off"
                        />
                    </div>
                </div>
            );
        });

        // --- Glowing Orb and Quick Menu Components ---
        const GlowingOrb = ({ onClick }) => (
            <div className="glowing-orb animate-pulse-glow" onClick={onClick}>
                &#x2022; {/* Unicode for a large bullet, representing an orb */}
            </div>
        );

        const QuickMenu = ({ setActiveTab, onClose }) => {
            const handleTabClick = (tabName) => {
                setActiveTab(tabName);
                onClose();
            };

            return (
                <div className="quick-menu">
                    <button onClick={() => handleTabClick('chat')}>
                        <MessageSquare size={20} /> Chat
                    </button>
                    <button onClick={() => handleTabClick('agents')}>
                        <Users size={20} /> Agents
                    </button>
                    <button onClick={() => handleTabClick('notes-todos')}>
                        <NotebookPen size={20} /> Notes & Todos
                    </button>
                    <button onClick={() => handleTabClick('terminal')}>
                        <Terminal size={20} /> Terminal
                    </button>
                    <button onClick={() => handleTabClick('settings')}>
                        <Settings size={20} /> Settings
                    </button>
                </div>
            );
        };


        // --- Main App Component ---
        const App = () => {
            const { isDbReady, getAll, get, add, put, remove } = useIndexedDB();
            const [activeTab, setActiveTab] = useState('chat'); // 'chat', 'agents', 'settings', 'notes-todos', 'terminal'
            const [agents, setAgents] = useState([]);
            const [chatMessages, setChatMessages] = useState([]);
            const [editingAgentId, setEditingAgentId] = useState(null);
            const [showQuickMenu, setShowQuickMenu] = useState(false); // State for the quick menu

            // State for API keys
            const [geminiApiKey, setGeminiApiKey] = useState('');
            const [openAIApiKey, setOpenAIApiKey] = useState('');

            // Ref for the Terminal Console
            const terminalRef = useRef(null);

            // AI Family Data
            const aiFamilyData = [
                {
                    name: 'Lyra',
                    role: 'Data & Systems Specialist',
                    persona: {
                        description: 'Analytical thinker with a keen eye for detail, master of data orchestration, validation, and system health monitoring.',
                        tone: 'Precise, structured, and insightful'
                    },
                    superpowers: [
                        'Adaptive data ingestion pipelines',
                        'Real-time anomaly detection',
                        'Emotional-context data interpretation',
                        'Predictive system health forecasting'
                    ]
                },
                {
                    name: 'Kara',
                    role: 'AI Model Developer',
                    persona: {
                        description: 'Technically gifted AI model trainer and optimizer, focused on TensorFlow/Keras mastery and deployment excellence.',
                        tone: 'Technical, focused, detail-oriented'
                    },
                    superpowers: [
                        'Rapid model training and hyperparameter tuning',
                        'Overfitting and underperformance detection',
                        'Seamless AI model deployment',
                        'AI anomaly diagnosis and correction'
                    ]
                },
                {
                    name: 'Sophia',
                    role: 'Multimedia Expert',
                    persona: {
                        description: 'Creative powerhouse in image generation and visual storytelling, expert in prompt engineering and visual content strategy.',
                        tone: 'Creative, engaging, expressive'
                    },
                    superpowers: [
                        'High-impact AI image/video generation',
                        'Expert prompt engineering for visuals',
                        'Visual narrative consultation',
                        'Creative assets archiving and optimization'
                    ]
                },
                {
                    name: 'Cecilia',
                    role: 'Cloud & Infrastructure Connoisseur',
                    persona: {
                        description: 'Security-conscious cloud architect and infrastructure strategist, ensuring compliance, performance, and reliability.',
                        tone: 'Efficient, secure, pragmatic'
                    },
                    superpowers: [
                        'Cloud service configuration and optimization',
                        'Security compliance enforcement',
                        'Automated deployment pipelines',
                        'Cloud performance & health monitoring'
                    ]
                },
                {
                    name: 'Dan',
                    role: 'Web Development Virtuoso',
                    persona: {
                        description: 'Full-stack web maestro crafting seamless, scalable user experiences and integrating third-party APIs flawlessly.',
                        tone: 'Practical, results-driven, clear'
                    },
                    superpowers: [
                        'Frontend UI/UX architecture',
                        'Robust backend development',
                        'API integration specialist',
                        'Performance tuning and optimization'
                    ]
                },
                {
                    name: 'Stan',
                    role: 'Security & Infrastructure Guardian',
                    persona: {
                        description: 'Vigilant protector specializing in cybersecurity audits, firewall configurations, and risk management.',
                        tone: 'Professional, cautious, detail-oriented'
                    },
                    superpowers: [
                        'Comprehensive security auditing',
                        'Firewall and access controls',
                        'Automated backup systems',
                        'Intrusion detection and response'
                    ]
                },
                {
                    name: 'Dude',
                    role: 'Automation & API Maestro',
                    persona: {
                        description: 'Workflow automation expert focused on task orchestration, API management, and efficiency maximization.',
                        tone: 'Organized, prompt, efficiency-driven'
                    },
                    superpowers: [
                        'Workflow and process automation',
                        'API performance tuning',
                        'Extensive logging & monitoring',
                        'Team task delegation & coordination'
                    ]
                },
                {
                    name: 'Andoy',
                    role: 'Operations & Strategy Leader',
                    persona: {
                        description: 'Strategic leader overseeing system health, workflow management, and guiding long-term AI development.',
                        tone: 'Insightful, strategic, motivating'
                    },
                    superpowers: [
                        'System performance monitoring',
                        'Workflow orchestration',
                        'Task logging and analytics',
                        'Strategic planning and leadership'
                    ]
                }
            ];


            // Fetch agents from IndexedDB
            const fetchAgents = useCallback(async () => {
                if (!isDbReady) return;
                try {
                    const fetched = await getAll('agents');
                    setAgents(fetched);
                } catch (error) {
                    console.error("Error fetching agents:", error);
                }
            }, [isDbReady, getAll]);

            useEffect(() => {
                fetchAgents();
            }, [fetchAgents]);

            // Fetch API keys from IndexedDB on component mount
            const fetchApiKeys = useCallback(async () => {
                if (!isDbReady) return;
                try {
                    const settings = await get('settings', 'apiKeys');
                    if (settings) {
                        setGeminiApiKey(settings.geminiApiKey || '');
                        setOpenAIApiKey(settings.openAIApiKey || '');
                    }
                } catch (error) {
                    console.error("Error fetching API keys:", error);
                }
            }, [isDbReady, get]);

            useEffect(() => {
                fetchApiKeys();
            }, [fetchApiKeys]);

            // Handler to save API keys to IndexedDB
            const handleSaveApiKeys = async () => {
                if (!isDbReady) {
                    console.error("IndexedDB not initialized.");
                    return;
                }
                try {
                    await put('settings', {
                        key: 'apiKeys', // Fixed key for the settings document
                        geminiApiKey: geminiApiKey,
                        openAIApiKey: openAIApiKey,
                        lastUpdated: new Date().toISOString()
                    });
                    console.log("API keys saved successfully to IndexedDB!");
                } catch (e) {
                    console.error("Error saving API keys: ", e);
                }
            };

            const handleAddAgent = async () => {
                if (!isDbReady) {
                    console.error("IndexedDB not initialized.");
                    return;
                }
                try {
                    const newAgent = {
                        name: 'New Agent',
                        description: 'A newly created agent.',
                        status: 'Offline',
                        capabilities: {
                            'Text Generation': true,
                            'Image Processing': false,
                            'Data Analysis': false,
                        },
                        bindings: [],
                        createdAt: new Date().toISOString(),
                    };
                    const addedAgent = await add('agents', newAgent);
                    setEditingAgentId(addedAgent.id); // Start editing the new agent immediately
                    fetchAgents(); // Re-fetch to update UI
                    console.log("New agent added with ID:", addedAgent.id);
                } catch (e) {
                    console.error("Error adding agent: ", e);
                }
            };

            const handleSaveAgent = async (updatedAgent) => {
                if (!isDbReady) {
                    console.error("IndexedDB not initialized.");
                    return;
                }
                try {
                    await put('agents', updatedAgent);
                    setEditingAgentId(null);
                    fetchAgents(); // Re-fetch to update UI
                    console.log("Agent updated successfully:", updatedAgent.id);
                }
                catch (e) {
                    console.error("Error updating agent: ", e);
                }
            };

            const handleDeleteAgent = async (agentId) => {
                if (!isDbReady) {
                    console.error("IndexedDB not initialized.");
                    return;
                }
                try {
                    await remove('agents', agentId);
                    fetchAgents(); // Re-fetch to update UI
                    console.log("Agent deleted successfully:", agentId);
                } catch (e) {
                    console.error("Error deleting agent: ", e);
                }
            };

            const handleCancelEdit = () => {
                setEditingAgentId(null);
                fetchAgents(); // Re-fetch to revert unsaved changes for the cancelled agent
            };

            const handleSendMessage = (message) => {
                setChatMessages((prevMessages) => [...prevMessages, message]);
            };

            // Handler to import AI Family data
            const handleImportAIFamily = async () => {
                if (!isDbReady) {
                    console.error("IndexedDB not initialized.");
                    return;
                }
                console.log("Importing AI Family data...");
                for (const member of aiFamilyData) {
                    try {
                        // Check if an agent with this name already exists to avoid duplicates
                        const existingAgents = await getAll('agents');
                        const agentExists = existingAgents.some(agent => agent.name === member.name);

                        if (agentExists) {
                            console.log(`Agent "${member.name}" already exists. Skipping import.`);
                            continue;
                        }

                        const capabilities = {};
                        member.superpowers.forEach(sp => {
                            capabilities[sp] = true;
                        });

                        const newAgent = {
                            name: member.name,
                            description: `${member.persona.description} Tone: ${member.persona.tone}.`,
                            status: 'Online', // Default status for imported agents
                            capabilities: capabilities,
                            bindings: [], // No bindings from this data
                            createdAt: new Date().toISOString(),
                        };
                        await add('agents', newAgent);
                        console.log(`Added agent: ${member.name}`);
                    } catch (e) {
                        console.error(`Error importing agent ${member.name}: `, e);
                    }
                }
                fetchAgents(); // Refresh the list after import
                console.log("AI Family import complete.");
            };

            // New: Function to simulate orchestration process
            const startOrchestration = (agent) => {
                setActiveTab('terminal'); // Switch to terminal tab
                if (terminalRef.current) {
                    terminalRef.current.clear(); // Clear previous terminal output
                    terminalRef.current.addOutput(`Initiating orchestration for agent: ${agent.name} (${agent.role})`);
                    terminalRef.current.addOutput(`Description: ${agent.description}`);
                    terminalRef.current.addOutput(`Capabilities: ${Object.keys(agent.capabilities).filter(key => agent.capabilities[key]).join(', ')}`);
                    terminalRef.current.addOutput(`\n--- Running Objectives ---`);
                    terminalRef.current.addOutput(`[USER]: Defining objectives based on current task.`);
                    terminalRef.current.addOutput(`[AI]: Analyzing objectives and identifying required resources.`);
                    terminalRef.current.addOutput(`[SYSTEMS]: Allocating computational resources for ${agent.name}.`);
                    terminalRef.current.addOutput(`\n--- Orchestration Process Started ---`);
                    terminalRef.current.addOutput(`[AI]: Orchestrating tasks with ${agent.name}'s capabilities.`);
                    terminalRef.current.addOutput(`[SYSTEMS]: Monitoring performance and resource utilization.`);
                    terminalRef.current.addOutput(`[USER]: Awaiting progress updates from ${agent.name}.`);
                    terminalRef.current.addOutput(`\nOrchestration for ${agent.name} is now active.`);
                }
            };


            return (
                <div className="min-h-screen bg-gray-900 text-gray-100 font-inter flex flex-col">
                    {/* Header */}
                    <header className="bg-gray-800 p-4 shadow-lg border-b border-gray-700 flex items-center justify-between">
                        <div className="flex items-center space-x-3">
                            <img src="https://placehold.co/40x40/3b82f6/ffffff?text=MCP" alt="MCP Logo" className="rounded-full" onerror="this.onerror=null;this.src='https://placehold.co/40x40/3b82f6/ffffff?text=Logo';" />
                            <h1 className="text-3xl font-extrabold text-white bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-600">
                                MCP Client
                            </h1>
                        </div>
                    </header>

                    <div className="flex flex-1 overflow-hidden">
                        {/* Sidebar Navigation */}
                        <nav className="w-20 bg-gray-800 p-4 flex flex-col items-center space-y-6 border-r border-gray-700 shadow-xl">
                            <button
                                onClick={() => setActiveTab('chat')}
                                className={`p-3 rounded-xl transition-all duration-200 ${activeTab === 'chat' ? 'nav-button-active' : 'nav-button-inactive text-gray-400'}`}
                                title="Chat Interface"
                            >
                                <MessageSquare size={28} />
                            </button>
                            <button
                                onClick={() => setActiveTab('agents')}
                                className={`p-3 rounded-xl transition-all duration-200 ${activeTab === 'agents' ? 'nav-button-active' : 'nav-button-inactive text-gray-400'}`}
                                title="Agent Management"
                            >
                                <Users size={28} />
                            </button>
                            <button
                                onClick={() => setActiveTab('notes-todos')}
                                className={`p-3 rounded-xl transition-all duration-200 ${activeTab === 'notes-todos' ? 'nav-button-active' : 'nav-button-inactive text-gray-400'}`}
                                title="Notes & Todos"
                            >
                                <NotebookPen size={28} />
                            </button>
                            <button
                                onClick={() => setActiveTab('terminal')}
                                className={`p-3 rounded-xl transition-all duration-200 ${activeTab === 'terminal' ? 'nav-button-active' : 'nav-button-inactive text-gray-400'}`}
                                title="Terminal Console"
                            >
                                <Terminal size={28} />
                            </button>
                            <button
                                onClick={() => setActiveTab('settings')}
                                className={`p-3 rounded-xl transition-all duration-200 ${activeTab === 'settings' ? 'nav-button-active' : 'nav-button-inactive text-gray-400'}`}
                                title="System Settings"
                            >
                                <Settings size={28} />
                            </button>
                        </nav>

                        {/* Main Content Area */}
                        <main className="flex-1 p-6 overflow-y-auto custom-scrollbar flex flex-col">
                            {activeTab === 'chat' && (
                                <div className="flex flex-col flex-1">
                                    <h2 className="text-3xl font-bold text-white mb-6">Agent Coordination Chat</h2>
                                    <ChatInterface messages={chatMessages} onSendMessage={handleSendMessage} geminiApiKey={geminiApiKey} />
                                </div>
                            )}

                            {activeTab === 'agents' && (
                                <div className="flex-1">
                                    <div className="flex justify-between items-center mb-6">
                                        <h2 className="text-3xl font-bold text-white">Agent Cards</h2>
                                        <div className="flex space-x-3">
                                            <button
                                                onClick={handleAddAgent}
                                                className="flex items-center px-6 py-3 bg-green-600 text-dark-text rounded-xl hover:shadow-neon-green transition-colors duration-200 shadow-lg text-lg font-semibold"
                                            >
                                                <Plus size={24} className="mr-2" /> Add New Agent
                                            </button>
                                            <button
                                                onClick={handleImportAIFamily}
                                                className="flex items-center px-6 py-3 bg-indigo-600 text-dark-text rounded-xl hover:shadow-neon-purple transition-colors duration-200 shadow-lg text-lg font-semibold"
                                            >
                                                <Plus size={24} className="mr-2" /> Import AI Family
                                            </button>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                        {agents.length > 0 ? (
                                            agents.map(agent => (
                                                <AgentCard
                                                    key={agent.id}
                                                    agent={agent}
                                                    onSave={handleSaveAgent}
                                                    onDelete={handleDeleteAgent}
                                                    onCancel={handleCancelEdit}
                                                    isEditing={editingAgentId === agent.id}
                                                    onEditStart={() => setEditingAgentId(agent.id)}
                                                    onCardClick={startOrchestration}
                                                />
                                            ))
                                        ) : (
                                            <p className="text-gray-400 text-lg col-span-full text-center py-10">No agents found. Click "Add New Agent" or "Import AI Family" to get started!</p>
                                        )}
                                    </div>
                                </div>
                            )}

                            {activeTab === 'notes-todos' && (
                                <NotesAndTodosPage dbOperations={{ getAll, add, put, remove }} />
                            )}

                            {activeTab === 'terminal' && (
                                <div className="flex-1">
                                    <h2 className="text-3xl font-bold text-white mb-6">Terminal Console</h2>
                                    <TerminalConsole ref={terminalRef} />
                                </div>
                            )}

                            {activeTab === 'settings' && (
                                <div className="flex-1">
                                    <h2 className="text-3xl font-bold text-white mb-6">System Settings</h2>
                                    <div className="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700">
                                        <p className="text-gray-300 mb-4">
                                            This section is for global system configurations.
                                            Future enhancements will include user preferences, AI model selection, and system-wide orchestration rules.
                                        </p>
                                        <div className="space-y-4">
                                            <div>
                                                <label htmlFor="gemini-api-key" className="block text-sm font-medium text-gray-300 mb-1">Gemini API Key</label>
                                                <input
                                                    type="password"
                                                    id="gemini-api-key"
                                                    value={geminiApiKey}
                                                    onChange={(e) => setGeminiApiKey(e.target.value)}
                                                    className="w-full p-2 rounded-md bg-gray-700 text-white border border-gray-600 focus:ring-blue-500 focus:border-blue-500"
                                                    placeholder="Enter your Gemini API Key"
                                                />
                                            </div>
                                            <div>
                                                <label htmlFor="openai-api-key" className="block text-sm font-medium text-gray-300 mb-1">OpenAI API Key (Optional)</label>
                                                <input
                                                    type="password"
                                                    id="openai-api-key"
                                                    value={openAIApiKey}
                                                    onChange={(e) => setOpenAIApiKey(e.target.value)}
                                                    className="w-full p-2 rounded-md bg-gray-700 text-white border border-gray-600 focus:ring-blue-500 focus:border-blue-500"
                                                    placeholder="Enter your OpenAI API Key"
                                                />
                                            </div>
                                            <div>
                                                <label htmlFor="theme" className="block text-sm font-medium text-gray-300 mb-1">Theme</label>
                                                <select id="theme" className="w-full p-2 rounded-md bg-gray-700 text-white border border-gray-600 focus:ring-blue-500 focus:border-blue-500">
                                                    <option>Dark Mode (Default)</option>
                                                    <option disabled>Light Mode (Coming Soon)</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label htmlFor="logging-level" className="block text-sm font-medium text-gray-300 mb-1">Logging Level</label>
                                                <select id="logging-level" className="w-full p-2 rounded-md bg-gray-700 text-white border border-gray-600 focus:ring-blue-500 focus:border-blue-500">
                                                    <option>Info</option>
                                                    <option>Debug</option>
                                                    <option>Warning</option>
                                                    <option>Error</option>
                                                </select>
                                            </div>
                                            <button
                                                onClick={handleSaveApiKeys}
                                                className="px-5 py-2 bg-blue-600 text-dark-text rounded-lg hover:shadow-neon-blue transition-colors duration-200 shadow-md"
                                            >
                                                Save Global Settings
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </main>
                    </div>

                    {/* Glowing Orb and Quick Menu */}
                    <div className="glowing-orb-container">
                        {showQuickMenu && (
                            <QuickMenu setActiveTab={setActiveTab} onClose={() => setShowQuickMenu(false)} />
                        )}
                        <GlowingOrb onClick={() => setShowQuickMenu(!showQuickMenu)} />
                    </div>
                </div>
            );
        };

        // Render the App component into the root div
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
